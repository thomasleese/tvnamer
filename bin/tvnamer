#!/usr/bin/env node

var async = require("async");
var fs = require("fs");
var optimist = require("optimist");
var tvnamer = require("../");

var waitForResponse = function(callback) {
	var stdin = process.stdin;
	
	stdin.resume();
	stdin.setEncoding("utf8");
	stdin.once("data", function(data) {
		stdin.pause();
		callback();
	});
};

async.each(optimist.argv._, function(showPath, next) {
	console.log("Renaming", showPath);
		
	tvnamer(showPath, function(err, paths) {
		for (var key in paths) {
			console.log(" ", key, "->", paths[key]);
		}
		
		console.log("Continue?");
		waitForResponse(function() {
			for (var key in paths) {
				fs.renameSync(key, paths[key]);
			}
			
			next();
		});
	});
}, function(err) {
	
});
